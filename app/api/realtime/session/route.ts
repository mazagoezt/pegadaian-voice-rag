
export const runtime="nodejs"; export const dynamic="force-dynamic";
import { NextResponse } from "next/server";
export async function GET(){ const model=process.env.REALTIME_MODEL||"gpt-4o-realtime-preview"; const voice=process.env.REALTIME_VOICE||"shimmer"; const key=process.env.OPENAI_API_KEY; if(!key) return NextResponse.json({ok:false,error:"OPENAI_API_KEY not set"},{status:500}); const r=await fetch("https://api.openai.com/v1/realtime/sessions",{method:"POST",headers:{"Authorization":`Bearer ${key}","Content-Type":"application/json","OpenAI-Beta":"realtime=v1"},body:JSON.stringify({model,voice})}); const txt=await r.text(); if(!r.ok) return NextResponse.json({ok:false,status:r.status,error:txt},{status:r.status}); let j:any={}; try{ j=JSON.parse(txt);}catch{} if(!j?.client_secret?.value) return NextResponse.json({ok:false,error:"No client_secret.value",raw:j},{status:500}); return NextResponse.json({...j,session_model:model}); }
